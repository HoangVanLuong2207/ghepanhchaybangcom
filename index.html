<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tool c·ªßa L∆∞·ª£ng</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center py-4 w-screen">
  <!-- N√∫t m·ªü h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng -->
  <button id="openGuideBtn" class="fixed top-4 left-4 z-60 bg-yellow-400 hover:bg-yellow-500 text-white font-semibold py-2 px-4 rounded shadow transition-all duration-200">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</button>
  <div class="w-full max-w-full bg-white rounded-lg shadow-lg p-2 sm:p-4 flex flex-col gap-4">
    <h1 class="text-2xl font-bold text-center text-blue-600 mb-2 sm:mb-4 drop-shadow">Tool c·ªßa L∆∞·ª£ng ƒë√≥ h·∫π h·∫π h·∫πh·∫π</h1>
    <!-- Profile Image Upload -->
    <div class="flex flex-col gap-2">
      <label for="inputProfileImage" class="font-semibold">1. T·∫£i ·∫£nh Profile (·∫£nh ch√≠nh):</label>
      <input type="file" id="inputProfileImage" accept="image/*" class="file:mr-2 file:py-1 file:px-3 file:rounded file:border-0 file:bg-blue-100 file:text-blue-700 text-sm" />
      <div class="flex justify-center my-2 w-full">
        <canvas id="profileCanvas" class="border-2 border-dashed border-blue-300 rounded shadow w-full h-auto min-h-32 max-h-64 bg-gray-100 transition-all duration-300"></canvas>
      </div>
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-2">
        <label for="profileCropX" class="text-xs">X:</label>
        <input type="number" id="profileCropX" value="0" class="border rounded px-2 py-1 text-xs" />
        <label for="profileCropY" class="text-xs">Y:</label>
        <input type="number" id="profileCropY" value="0" class="border rounded px-2 py-1 text-xs" />
        <label for="profileCropW" class="text-xs">R·ªông:</label>
        <input type="number" id="profileCropW" value="0" class="border rounded px-2 py-1 text-xs" />
        <label for="profileCropH" class="text-xs">Cao:</label>
        <input type="number" id="profileCropH" value="0" class="border rounded px-2 py-1 text-xs" />
      </div>
      <div id="croppedPreviewSection" class="mt-4 hidden">
        <h2 class="font-semibold mb-2 flex items-center gap-2 text-lg text-gray-700"><span>üñºÔ∏è</span>·∫¢nh ƒê√£ C·∫Øt:</h2>
        <div class="flex flex-wrap gap-4 justify-center">
          <div id="croppedProfileContainer" class="flex flex-col items-center p-4 bg-blue-50 rounded shadow border border-blue-200 min-w-[150px]">
              <span class="text-xs text-blue-700 font-semibold mb-1">·∫¢nh Profile</span>
              <img id="croppedProfileImg" src="ƒë∆∞·ªùng_d·∫´n_t·ªõi_·∫£nh_c·ªßa_b·∫°n.jpg" alt="Profile ƒë√£ c·∫Øt" class="rounded border border-blue-300 shadow w-28 h-auto mb-1" />
          </div>
      </div>
      </div>
      <button onclick="processAndShowCroppedImages()"  class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded shadow transition-all duration-200 w-fit">‚úÇÔ∏è C·∫Øt ·∫¢nh (B∆∞·ªõc 4)</button>
    </div>
    <!-- Batch Images Upload (Ch·ªçn skin t·ª´ th∆∞ vi·ªán) -->
    <div class="flex flex-col gap-2 mt-2">
      <label class="font-semibold">2. Ch·ªçn ·∫£nh skin t·ª´ th∆∞ vi·ªán c√≥ s·∫µn:</label>
      <button id="openSkinLibraryBtn" type="button" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded shadow w-fit">Ch·ªçn skin</button>
      <div class="mt-2">
        <span class="text-xs text-gray-500">ƒê√£ ch·ªçn: <span id="selectedSkinCount">0</span> ·∫£nh</span>
      </div>
    </div>
    <!-- Popup th∆∞ vi·ªán ·∫£nh skin -->
    <div id="skinLibraryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-white rounded-lg shadow-lg p-4 w-full max-w-3xl relative flex flex-col items-center max-h-[90vh] overflow-y-auto">
        <button id="closeSkinLibraryBtn" class="absolute top-2 right-2 text-gray-500 hover:text-red-500 text-2xl font-bold">&times;</button>
        <h2 class="text-lg font-bold mb-2 text-blue-700">Th∆∞ vi·ªán ·∫£nh skin</h2>
        <input id="skinLibrarySearch" type="text" placeholder="T√¨m ki·∫øm theo t√™n ·∫£nh..." class="border rounded px-2 py-1 text-sm mb-4 w-full max-w-md" />
        <div id="skinLibraryGrid" class="grid grid-cols-2 sm:grid-cols-4 gap-2 w-full pb-20"></div>
        <button id="confirmSkinSelectionBtn" class="fixed left-1/2 -translate-x-1/2 bottom-4 z-60 bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-6 rounded shadow max-w-3xl w-[90%]">Ch·ªçn c√°c ·∫£nh ƒë√£ ch·ªçn</button>
      </div>
    </div>
      <!-- Cropped Images Preview -->
      
      <!-- Combine Config -->
    <div class="flex flex-col gap-2 mt-4">
      <h2 class="font-semibold">3. C·∫•u h√¨nh Gh√©p ·∫¢nh:</h2>
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-2">
        <label for="combineCols" class="text-xs">S·ªë c·ªôt (t·ªëi thi·ªÉu 2):</label>
        <input type="number" id="combineCols" value="4" min="2" class="border rounded px-2 py-1 text-xs" />
        <label for="combineRows" class="text-xs">S·ªë h√†ng (t·ªëi thi·ªÉu 2): <span class="text-red-500">k·∫øt qu·∫£ tr·∫£ ra s·∫Ω +1 h√†ng v√¨ c√≥ ·∫£nh profile s·∫Ω g√¥m 2 h√†ng</span></label>
        <input type="number" id="combineRows" value="4" min="2" class="border rounded px-2 py-1 text-xs" />
      </div>
    </div>
   
    <!-- Crop and Combine Buttons -->
    <div class="flex flex-col sm:flex-row gap-2 mt-4">
      <button onclick="combineImages()" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded shadow transition-all duration-200 w-fit">üß© Gh√©p ·∫¢nh (B∆∞·ªõc 5)</button>
    </div>
   
   
    <!-- Final Output (·∫©n canvas, ch·ªâ d√πng cho xu·∫•t ·∫£nh ra modal) -->
    <div class="hidden">
      <canvas id="finalOutputCanvas"></canvas>
    </div>
    <!-- Modal popup hi·ªÉn th·ªã ·∫£nh c·∫Øt ra v√† ·∫£nh gh√©p cu·ªëi c√πng -->
    <div id="imageModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-white rounded-lg shadow-lg p-2 sm:p-4 relative max-w-full max-h-full flex flex-col items-center">
        <button id="closeModalBtn" class="absolute top-2 right-2 text-gray-500 hover:text-red-500 text-2xl font-bold">&times;</button>
        <img id="modalImage" src="" alt="·∫¢nh s·∫£n ph·∫©m" class="w-full h-auto rounded border border-gray-200" style="max-width:none; max-height:80vh;" />
        <a id="downloadCombinedImage" class="block mt-2 bg-purple-500 hover:bg-purple-600 text-white text-center font-semibold py-2 rounded shadow" style="display:none;" download="combined_image.png">T·∫£i ·∫¢nh Gh√©p V·ªÅ</a>
      </div>
    </div>
    <!-- Loading overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
      <div class="flex flex-col items-center">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500"></div>
        <span class="mt-4 text-white font-semibold text-lg drop-shadow">ƒêang x·ª≠ l√Ω ·∫£nh...</span>
      </div>
    </div>
  </div>
  <!-- Modal h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng -->
  <div id="guideModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60">
    <div class="bg-white rounded-lg shadow-lg p-6 w-4/5 max-w-4xl relative flex flex-col items-center overflow-y-auto max-h-[90vh]">
      <h2 class="text-xl font-bold mb-4 text-blue-700">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h2>
      <ul class="text-gray-700 text-left list-disc pl-6 mb-4">
        <h2 class="text-lg font-bold mb-2 text-blue-700">1.T·∫£i ·∫£nh profile (·∫£nh ch√≠nh) v√† ch·ªçn v√πng c·∫Øt ph√π h·ª£p.</h2>
        <div class="text-red-500">
          <li>Tr∆∞·ªõc khi c·∫Øt ·∫£nh</li><img src="profileGoc.jpg" alt="·∫¢nh profile g·ªëc" class="max-w-full h-auto block my-2 border border-gray-300 rounded" />
          <li>Sau khi c·∫Øt ·∫£nh</li><img src="profile.png" alt="·∫¢nh profile ƒë√£ c·∫Øt" class="max-w-full h-auto block my-2 border border-gray-300 rounded" />
        </div>
        <h2 class="text-lg font-bold mb-2 text-blue-700">1.T·∫£i ·∫£nh profile (·∫£nh ch√≠nh) v√† ch·ªçn v√πng c·∫Øt ph√π h·ª£p.</h2>
        <h2 class="text-lg font-bold mb-2 text-blue-700">2. T√¨m ki·∫øm v√† ch·ªçn ·∫£nh</h2>
        <li class="text-red-500">Sau khi ch·ªçn ·∫£nh xong ph·∫£i x√°c nh·∫°n m·ªõi c√≥ th·ªÉ s·ª≠ d·ª•ng ·∫£nh</li>
        <li class="text-red-500">Kho d·ªØ li·ªáu skin ƒë∆∞·ª£c admin c·∫≠p nh√¢t th·ªß c√¥ng n√™n m·ªôt s·ªë skin m·ªõi c√≥ th·ªÉ ch∆∞a l√™n ngayngay</li>
        <div>
          <p>V√≠ d·ª• m·∫´u</p>
          <img src="combined_image.png" alt="·∫¢nh gh√©p" class="max-w-full h-auto block my-2 border border-gray-300 rounded" />
          <li class="text-red-500">S·ªë c·ªôt: 10</li>
          <li class="text-red-500">S·ªë h√†ng: 5 (k·∫øt qu·∫£ tr·∫£ ra s·∫Ω +1 h√†ng v√¨ c√≥ ·∫£nh profile s·∫Ω g√¥m 2 h√†ng)</li>
        </div>

        
        <h2 class="text-lg font-bold mb-2 text-blue-700">4.B·∫•m "C·∫Øt ·∫¢nh" ƒë·ªÉ x·ª≠ l√Ω ·∫£nh, sau ƒë√≥ b·∫•m "Gh√©p ·∫¢nh" ƒë·ªÉ t·∫°o ·∫£nh cu·ªëi c√πng.</h2>
        <li class="text-red-500">Khi gh√©p ·∫£nh ch·ªâ c·∫ßn nh·∫•n 1 l·∫ßn v√† ch·ªù 5-10s s·∫Ω t·ª± tr·∫£ v·ªÅ ·∫£nh th√†nh ph·∫©m </li>
        <h2 class="text-lg font-bold mb-2 text-blue-700">5.C√≥ th·ªÉ t·∫£i ·∫£nh gh√©p v·ªÅ m√°y ho·∫∑c thao t√°c l·∫°i n·∫øu c·∫ßn.</h2>
        <li class="text-red-500">Khi t·∫£i ·∫£nh v·ªÅ m√°y th√¨ ·∫£nh s·∫Ω c√≥ ƒë·ªãnh d·∫°ng png</li>
        <li class="text-red-500">Th√¥ng s·ªë tr∆∞·ªõc khi c·∫Øt ·∫£nh c√≥ th·ªÉ s·ª≠a tr·ª±c ti·∫øp m√† kh√¥ng c·∫ßn ph·∫£i t·∫£i l·∫°i ·∫£nh l√™n</li>
        <li class="text-red-500">C·∫•u h√¨nh ·∫£nh gh√©p c√≥ th·ªÉ s·ª≠a tr·ª±c ti·∫øp m√† kh√¥ng c·∫ßn ph·∫£i th·ª±c hi·ªán c·∫Øt l·∫°i ·∫£nh</li>
        <h2 class="text-lg font-bold mb-2 text-blue-700">6.N·∫øu g·∫∑p l·ªói popup kh√¥ng ƒë√≥ng ƒë∆∞·ª£c, h√£y F5 l·∫°i trang.</h2>
        <li class="text-red-500">ƒê√¥i khi server lag d·∫´n ƒë·∫øn ch·ª©c nƒÉng kh√¥ng ho·∫°t ƒë·ªông nh∆∞ √Ω mu·ªën, h√£y reload l·∫°i trang v√† th·ª≠ l·∫°il·∫°i.</li>
        <h2 class="text-lg font-bold mb-2 text-blue-700">7.D·ª± √°n 100% mi·ªÖn ph√≠ v√† kh√¥ng c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n.</h2>
        <li class="text-red-500">N·∫øu c√≥ l·ªói, hay √Ω t∆∞·ªüng ph√°t tri·ªÉn c√≥ th·ªÉ li√™n h·ªá qua <br> Email: <a href="mailto:luonghvpp03220@gmail.com" class="text-blue-500">pp03220@gmail.com</a>
       ho·∫∑c Zalo <a href="https://zalo.me/0899333293" class="text-blue-500">0899333293</a></li>
      </ul>
      <button id="closeGuideBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-6 rounded shadow">T√¥i ƒë√£ ƒë·ªçc k·ªπ h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</button>
    </div>
  </div>
  <script src="js.js" type="module"></script>
</body>
</html>