<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cắt & Ghép Ảnh Nâng Cao (Mobile-Friendly & Tùy chọn ghép)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css.css">
</head>
<body>
    <h1>Công Cụ Cắt & Ghép Ảnh</h1>

    <div class="input-group">
        <label for="inputProfileImage">1. Tải ảnh Profile (ảnh chính):</label>
        <input type="file" id="inputProfileImage" accept="image/*">
        <div class="canvas-container profile-canvas-container">
            <canvas id="profileCanvas"></canvas>
        </div>
        <h3>Cắt ảnh Profile:</h3>
        <label for="profileCropX">X:</label>
        <input type="number" id="profileCropX" value="0">
        <label for="profileCropY">Y:</label>
        <input type="number" id="profileCropY" value="0">
        <label for="profileCropW">Rộng:</label>
        <input type="number" id="profileCropW" value="0">
        <label for="profileCropH">Cao:</label>
        <input type="number" id="profileCropH" value="0">
    </div>

    <div class="input-group">
        <label for="inputImages">2. Tải ảnh sản phẩm (hàng loạt):</label>
        <input type="file" id="inputImages" accept="image/*" multiple>
        <div class="canvas-container preview-canvas-container">
            <canvas id="previewCanvas"></canvas>
        </div>
        <h3>Cắt ảnh Sản phẩm:</h3>
        <label for="batchCropX">X:</label>
        <input type="number" id="batchCropX" value="0">
        <label for="batchCropY">Y:</label>
        <input type="number" id="batchCropY" value="0">
        <label for="batchCropW">Rộng:</label>
        <input type="number" id="batchCropW" value="0">
        <label for="batchCropH">Cao:</label>
        <input type="number" id="batchCropH" value="0">
    </div>

    <div class="input-group">
        <button onclick="processAndShowCroppedImages()">Cắt Ảnh (Bước 3)</button>
        <a id="downloadAll" class="button-link" style="display:none;" download="cropped_images.zip">Tải Tất Cả Ảnh Đã Cắt (ZIP)</a>
        <h2>Ảnh Sản Phẩm Đã Cắt:</h2>
        <div id="croppedImagesContainer">
            </div>
    </div>

    <div class="input-group">
        <h2>4. Cấu hình Ghép Ảnh:</h2>
        <label for="combineCols">Số cột (tối thiểu 2):</label>
        <input type="number" id="combineCols" value="4" min="2">
        <label for="combineRows">Số hàng (tối thiểu 2):</label>
        <input type="number" id="combineRows" value="4" min="2">
        <button onclick="combineImages()">Ghép Ảnh (Bước 5)</button>
        
        <a id="showCombinedImagePopup" class="button-link" style="display:none;">Xem Ảnh Ghép</a>
    </div>

    <h2>6. Ảnh Ghép Cuối Cùng:</h2>
    <div>
        <canvas id="finalOutputCanvas"></canvas>
    </div>
    <div id="imageModal" class="modal">
        <span class="close-button">&times;</span>
        <img class="modal-content" id="modalImage">
        <a id="downloadCombinedImage" class="button-link download-button-modal" download="combined_image.png">Tải Ảnh Ghép Về</a>
    </div>

    <script src="js.js"></script>
</body>
</html>